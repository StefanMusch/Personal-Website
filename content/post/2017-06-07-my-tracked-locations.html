---
title: My Tracked Locations
author: Stefan Musch
date: '2017-06-07'
output:
  blogdown::html_page:
    toc: true
    highlight: "tango"
slug: my-tracked-locations
categories:
  - Hobby Projects
  - R
tags:
  - Data Analysis
  - Data Visualisation
  - Leaflet
  - Google
thumbnailImage: "http://res.cloudinary.com/stefanmusch/image/upload/v1513250788/thumbnail/Maps.png"
coverImage: "http://res.cloudinary.com/stefanmusch/image/upload/c_fill,g_custom,h_600,w_1980/v1513248425/cover/cover5.jpg"
coverSize: partial
description: "In 2016 I let google track my location. Everytime my phone sent an update to google, a new record was created. By adding up records for each longitude and latitude coordinates combination, I was able to recreate the spots where I spent most of my time."
---

<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/pymjs/pym.v1.js"></script>
<script src="/rmarkdown-libs/widgetframe-binding/widgetframe.js"></script>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<div id="TOC">
<ul>
<li><a href="#visualising-google-tracking-data">Visualising Google Tracking Data</a><ul>
<li><a href="#loading-cleaning-data">Loading &amp; Cleaning data</a></li>
<li><a href="#static-visualisation">Static Visualisation</a></li>
<li><a href="#interactive-visualisation">Interactive Visualisation</a></li>
</ul></li>
</ul>
</div>

<div id="visualising-google-tracking-data" class="section level1">
<h1>Visualising Google Tracking Data</h1>
<p>In 2016 I let google track my location. Everytime my phone sent an update to google, a new record was created. By adding up records for each longitude and latitude coordinates combination, I was able to recreate the spots where I spent most of my time.</p>
<div id="loading-cleaning-data" class="section level2">
<h2>Loading &amp; Cleaning data</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">## Load packages &amp; Install if necessary</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">ipak &lt;-<span class="st"> </span><span class="cf">function</span>(pkg) {</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">  new.pkg &lt;-<span class="st"> </span>pkg[<span class="op">!</span>(pkg <span class="op">%in%</span><span class="st"> </span><span class="kw">installed.packages</span>()[, <span class="st">&quot;Package&quot;</span>])]</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">  <span class="cf">if</span> (<span class="kw">length</span>(new.pkg))</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">  <span class="kw">install.packages</span>(new.pkg, <span class="dt">dependencies =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6">  <span class="kw">sapply</span>(pkg, require, <span class="dt">character.only =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">}</a>
<a class="sourceLine" id="cb1-8" data-line-number="8"></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"></a>
<a class="sourceLine" id="cb1-10" data-line-number="10">packages &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;ggplot2&quot;</span>, <span class="st">&quot;jsonlite&quot;</span>, <span class="st">&quot;dplyr&quot;</span>, <span class="st">&quot;ggmap&quot;</span>, <span class="st">&quot;leaflet&quot;</span>, <span class="st">&quot;leaflet.extras&quot;</span>, <span class="st">&quot;rmarkdown&quot;</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11">              ,<span class="st">&quot;widgetframe&quot;</span>, <span class="st">&quot;gridExtra&quot;</span>)</a>
<a class="sourceLine" id="cb1-12" data-line-number="12"></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="kw">ipak</span>(packages)</a></code></pre></div>
<pre><code>##        ggplot2       jsonlite          dplyr          ggmap        leaflet 
##           TRUE           TRUE           TRUE           TRUE           TRUE 
## leaflet.extras      rmarkdown    widgetframe      gridExtra 
##           TRUE           TRUE           TRUE           TRUE</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">## Load data</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">## Create a smaller RDS file to use.</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co"># data &lt;- fromJSON(&quot;../../data/Google_Locations/Locatiegeschiedenis.json&quot;)</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co"># locations &lt;- data$locations</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co"># saveRDS(locations, file = &quot;../../data/Google_Locations/locations.rds&quot;)</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"></a>
<a class="sourceLine" id="cb3-7" data-line-number="7">locations &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="dt">file =</span> <span class="st">&quot;../../data/Google_Locations/locations.rds&quot;</span>)</a>
<a class="sourceLine" id="cb3-8" data-line-number="8"></a>
<a class="sourceLine" id="cb3-9" data-line-number="9">## Clean data</a>
<a class="sourceLine" id="cb3-10" data-line-number="10">locations<span class="op">$</span>timestampMs &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(locations<span class="op">$</span>timestampMs)</a>
<a class="sourceLine" id="cb3-11" data-line-number="11">locations &lt;-<span class="st"> </span>locations <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">time =</span> timestampMs <span class="op">/</span><span class="st"> </span><span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="kw">class</span>(locations<span class="op">$</span>time) &lt;-<span class="st"> &quot;POSIXct&quot;</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"></a>
<a class="sourceLine" id="cb3-15" data-line-number="15">## Converting Longitude and Latitude</a>
<a class="sourceLine" id="cb3-16" data-line-number="16">locations &lt;-<span class="st"> </span>locations <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">lat =</span> latitudeE7<span class="op">/</span><span class="fl">1E7</span>, <span class="dt">lon =</span> longitudeE7 <span class="op">/</span><span class="st"> </span><span class="fl">1E7</span>)</a>
<a class="sourceLine" id="cb3-18" data-line-number="18"></a>
<a class="sourceLine" id="cb3-19" data-line-number="19">## Get Stamen maps</a>
<a class="sourceLine" id="cb3-20" data-line-number="20">Nederland &lt;-<span class="st"> </span><span class="kw">get_map</span>(<span class="kw">c</span>(<span class="fl">5.0919143</span>, <span class="fl">51.560596</span>), <span class="dt">zoom =</span> <span class="dv">8</span>,</a>
<a class="sourceLine" id="cb3-21" data-line-number="21">                     <span class="dt">source=</span><span class="st">&#39;stamen&#39;</span>,<span class="dt">maptype=</span><span class="st">&quot;watercolor&quot;</span>)</a>
<a class="sourceLine" id="cb3-22" data-line-number="22">Tilburg &lt;-<span class="st"> </span><span class="kw">get_map</span>(<span class="kw">c</span>(<span class="fl">5.0919143</span>, <span class="fl">51.560596</span>), <span class="dt">zoom =</span> <span class="dv">13</span>,</a>
<a class="sourceLine" id="cb3-23" data-line-number="23">                   <span class="dt">source=</span><span class="st">&#39;stamen&#39;</span>,<span class="dt">maptype=</span><span class="st">&quot;watercolor&quot;</span>)</a>
<a class="sourceLine" id="cb3-24" data-line-number="24"></a>
<a class="sourceLine" id="cb3-25" data-line-number="25">Locations_Aantal &lt;-<span class="st"> </span>locations <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-26" data-line-number="26"><span class="st">  </span><span class="kw">group_by</span>(lon, lat) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-27" data-line-number="27"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">Aantal =</span> <span class="kw">n</span>())</a></code></pre></div>
</div>
<div id="static-visualisation" class="section level2">
<h2>Static Visualisation</h2>
<p>See below a map of The Netherlands as well as my home city Tilburg. I’m sure you can figure out where I’ve lived, studied, worked or even partied! Scroll further down to see a intereactive leaflet map.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">## Map of the Netherlands</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">NederlandLocaties &lt;-<span class="st"> </span><span class="kw">ggmap</span>(Nederland) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> Locations_Aantal, </a>
<a class="sourceLine" id="cb4-4" data-line-number="4">             <span class="kw">aes</span>(lon,lat, <span class="dt">alpha =</span> Aantal), </a>
<a class="sourceLine" id="cb4-5" data-line-number="5">             <span class="dt">color =</span> <span class="st">&quot;DarkRed&quot;</span>, <span class="dt">size =</span> <span class="fl">1.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Netherlands&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="st">  </span><span class="kw">guides</span>(<span class="dt">alpha=</span><span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb4-8" data-line-number="8">         <span class="dt">size =</span> <span class="ot">FALSE</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_size_continuous</span>(<span class="dt">range =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span><span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb4-11" data-line-number="11">        <span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb4-12" data-line-number="12">        <span class="dt">axis.text.x=</span><span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb4-13" data-line-number="13">        <span class="dt">axis.ticks.x=</span><span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb4-14" data-line-number="14">        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb4-15" data-line-number="15">        <span class="dt">axis.text.y=</span><span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb4-16" data-line-number="16">        <span class="dt">axis.ticks.y=</span><span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb4-17" data-line-number="17"></a>
<a class="sourceLine" id="cb4-18" data-line-number="18">## Map of Tilburg</a>
<a class="sourceLine" id="cb4-19" data-line-number="19">TilburgLocaties &lt;-<span class="st"> </span><span class="kw">ggmap</span>(Tilburg) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data=</span> Locations_Aantal, </a>
<a class="sourceLine" id="cb4-21" data-line-number="21">             <span class="kw">aes</span>(lon,lat, <span class="dt">alpha =</span> Aantal),</a>
<a class="sourceLine" id="cb4-22" data-line-number="22">             <span class="dt">color=</span><span class="st">&quot;DarkRed&quot;</span>, <span class="dt">size =</span> <span class="fl">1.5</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-23" data-line-number="23"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Tilburg, Noord-Brabant&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-24" data-line-number="24"><span class="st">  </span><span class="kw">guides</span>(<span class="dt">alpha=</span><span class="ot">FALSE</span>, <span class="dt">size =</span> <span class="ot">FALSE</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb4-25" data-line-number="25"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span><span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb4-26" data-line-number="26">        <span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb4-27" data-line-number="27">        <span class="dt">axis.text.x=</span><span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb4-28" data-line-number="28">        <span class="dt">axis.ticks.x=</span><span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb4-29" data-line-number="29">        <span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb4-30" data-line-number="30">        <span class="dt">axis.text.y=</span><span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb4-31" data-line-number="31">        <span class="dt">axis.ticks.y=</span><span class="kw">element_blank</span>())</a></code></pre></div>
<center>
<img src="/post/2017-06-07-my-tracked-locations_files/figure-html/unnamed-chunk-4-1.png" width="672" />
</center>
</div>
<div id="interactive-visualisation" class="section level2">
<h2>Interactive Visualisation</h2>
<p>Below you can find an interactive map of my location. Scroll closer to enhance the clusters or heatmap and find out where I’ve been. It even shows where I went on holidays during this year!</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">## Create interactive Leaflet Map</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">Int_Map &lt;-<span class="st"> </span>Locations_Aantal <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="st">  </span>leaflet <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="st">  </span><span class="kw">addProviderTiles</span>(providers<span class="op">$</span>OpenStreetMap) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="st">  </span><span class="kw">setView</span>(<span class="dt">lng =</span> <span class="fl">5.0919143</span>, <span class="dt">lat =</span> <span class="fl">51.560596</span>, <span class="dt">zoom =</span> <span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="st">  </span><span class="kw">addTiles</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="st">  </span><span class="kw">addMarkers</span>(<span class="op">~</span>lon, <span class="op">~</span>lat,  <span class="dt">clusterOptions =</span> <span class="kw">markerClusterOptions</span>(),</a>
<a class="sourceLine" id="cb5-8" data-line-number="8">             <span class="dt">group =</span> <span class="st">&quot;Cluster&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="st">  </span><span class="kw">addHeatmap</span>(<span class="dt">lng =</span> <span class="op">~</span>lon, <span class="dt">lat =</span> <span class="op">~</span>lat, <span class="dt">intensity =</span> <span class="op">~</span>Aantal,</a>
<a class="sourceLine" id="cb5-10" data-line-number="10">             <span class="dt">blur =</span> <span class="dv">20</span>, <span class="dt">max =</span> <span class="fl">0.05</span>, <span class="dt">radius =</span> <span class="dv">15</span>,</a>
<a class="sourceLine" id="cb5-11" data-line-number="11">             <span class="dt">group =</span> <span class="st">&quot;Heatmap&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="st">  </span><span class="kw">addLayersControl</span>(</a>
<a class="sourceLine" id="cb5-13" data-line-number="13">        <span class="dt">overlayGroups=</span><span class="kw">c</span>(<span class="st">&quot;Cluster&quot;</span>, <span class="st">&quot;Heatmap&quot;</span>),</a>
<a class="sourceLine" id="cb5-14" data-line-number="14">        <span class="dt">options=</span><span class="kw">layersControlOptions</span>(<span class="dt">collapsed=</span><span class="ot">FALSE</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="st">    </span><span class="kw">hideGroup</span>(<span class="kw">c</span>(<span class="st">&quot;Heatmap&quot;</span>))</a></code></pre></div>
<center>
<div id="htmlwidget-1" style="width:100%;height:480px;" class="widgetframe html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"url":"/post/2017-06-07-my-tracked-locations_files/figure-html//widgets/widget_unnamed-chunk-6.html","options":{"xdomain":"*","allowfullscreen":false,"lazyload":false}},"evals":[],"jsHooks":[]}</script>
</center>
</div>
</div>
